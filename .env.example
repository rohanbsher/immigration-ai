# =============================================================================
# Immigration AI - Environment Configuration
# =============================================================================
# Copy this file to .env.local and fill in your values
# NEVER commit .env.local to version control
# =============================================================================

# -----------------------------------------------------------------------------
# REQUIRED - Core Infrastructure
# -----------------------------------------------------------------------------

# Supabase (https://supabase.com)
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key

# App URL (your deployment URL, http://localhost:3000 for development)
NEXT_PUBLIC_APP_URL=http://localhost:3000
# Site URL for CSRF validation (same as APP_URL in most cases)
NEXT_PUBLIC_SITE_URL=http://localhost:3000

# -----------------------------------------------------------------------------
# REQUIRED - AI Services
# -----------------------------------------------------------------------------

# OpenAI (https://platform.openai.com) - Used for document OCR/vision
OPENAI_API_KEY=sk-...

# Anthropic Claude (https://console.anthropic.com) - Used for form autofill
ANTHROPIC_API_KEY=sk-ant-...

# -----------------------------------------------------------------------------
# REQUIRED FOR PRODUCTION - Security
# -----------------------------------------------------------------------------

# Encryption key for PII data (MUST be 64 hex characters = 32 bytes)
# Generate with: openssl rand -hex 32
ENCRYPTION_KEY=your-64-character-hex-encryption-key-generate-with-openssl

# Cron job authentication secret (for Vercel Cron or external schedulers)
# Minimum 16 characters. Generate with: openssl rand -hex 16
# (produces 32 hex characters = 16 bytes of entropy)
# REQUIRED: Scheduled tasks (deadline alerts) will fail without this
CRON_SECRET=

# -----------------------------------------------------------------------------
# REQUIRED FOR PRODUCTION - Virus Scanning
# File uploads will be REJECTED without proper virus scanning configuration
# -----------------------------------------------------------------------------

# Provider: 'clamav' or 'virustotal' (DO NOT use 'mock' in production)
VIRUS_SCANNER_PROVIDER=clamav

# ClamAV REST API endpoint (if using clamav)
# Self-host or use a service like clamav-rest
CLAMAV_API_URL=http://clamav-api:3000

# VirusTotal API key (if using virustotal)
# Get from: https://www.virustotal.com/gui/my-apikey
# VIRUSTOTAL_API_KEY=your-virustotal-api-key

# -----------------------------------------------------------------------------
# OPTIONAL - PDF Service (Railway-hosted USCIS PDF filler)
# Required for generating filing-ready USCIS PDFs (falls back to DRAFT summary without)
# -----------------------------------------------------------------------------

# PDF service URL (deploy services/pdf-service/ to Railway)
PDF_SERVICE_URL=https://your-pdf-service.railway.app
# PDF service authentication secret (minimum 32 characters)
# Generate with: openssl rand -hex 16
PDF_SERVICE_SECRET=

# -----------------------------------------------------------------------------
# OPTIONAL - Stripe Billing (https://stripe.com)
# Required only if using subscription billing features
# -----------------------------------------------------------------------------

# Stripe API keys
STRIPE_SECRET_KEY=sk_test_...
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...

# Stripe Price IDs (create in Stripe Dashboard > Products)
STRIPE_PRICE_PRO_MONTHLY=price_...
STRIPE_PRICE_PRO_YEARLY=price_...
STRIPE_PRICE_ENTERPRISE_MONTHLY=price_...
STRIPE_PRICE_ENTERPRISE_YEARLY=price_...

# -----------------------------------------------------------------------------
# OPTIONAL - Email (https://resend.com)
# Required only if using transactional emails
# -----------------------------------------------------------------------------

RESEND_API_KEY=re_...
EMAIL_FROM=Immigration AI <noreply@yourdomain.com>
EMAIL_REPLY_TO=support@yourdomain.com

# -----------------------------------------------------------------------------
# OPTIONAL - Rate Limiting (https://upstash.com)
# Uses in-memory fallback if not set (not suitable for production with multiple instances)
# Free tier: 10K commands/day
# -----------------------------------------------------------------------------

UPSTASH_REDIS_REST_URL=https://...upstash.io
UPSTASH_REDIS_REST_TOKEN=...

# Set to "true" to allow in-memory rate limiting fallback during development/build
# Required for builds when Redis is not configured
# ALLOW_IN_MEMORY_RATE_LIMIT=true

# -----------------------------------------------------------------------------
# OPTIONAL - Error Tracking (https://sentry.io)
# Required for production error monitoring
# -----------------------------------------------------------------------------

# Sentry DSN (from Project Settings > Client Keys)
SENTRY_DSN=https://...@sentry.io/...
NEXT_PUBLIC_SENTRY_DSN=https://...@sentry.io/...

# Sentry organization and project (for source map uploads)
SENTRY_ORG=your-org
SENTRY_PROJECT=immigration-ai

# Sentry auth token (from User Settings > Auth Tokens)
# Required for source map uploads
SENTRY_AUTH_TOKEN=sntrys_...

# -----------------------------------------------------------------------------
# OPTIONAL - Analytics (https://posthog.com)
# -----------------------------------------------------------------------------

NEXT_PUBLIC_POSTHOG_KEY=phc_...
NEXT_PUBLIC_POSTHOG_HOST=https://app.posthog.com

# -----------------------------------------------------------------------------
# AUTO-SET - Platform Variables (do not set manually)
# These are automatically set by Vercel/Node.js
# -----------------------------------------------------------------------------

# NODE_ENV - Set by Node.js (development, production, test)
# VERCEL_URL - Set by Vercel for preview deployments
